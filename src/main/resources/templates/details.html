<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>森林书城-DETAILS</title>
    <link rel="stylesheet" type="text/css" href="/bootstrap-3.3.7-dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="/bootstrap-3.3.7-dist/main.css"/>
    <script src="/bootstrap-3.3.7-dist/js/test.js" type="text/javascript"></script>
    <script src="/bootstrap-3.3.7-dist/js/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="/bootstrap-3.3.7-dist/js/bootstrap.min.js" type="text/javascript"></script>
</head>

<body>
<!--导航栏-->
<div class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <a href="index" class="navbar-brand"></a>
        </div>
        <ul class="nav navbar-nav">
            <li><a href="index">主页-书城</a></li>
            <li><a href="rankingList">排行榜</a></li>
            <li><a href="community">社区</a></li>
            <li><a href="cart">购物车</a></li>
            <li><a href="orders">我的订单</a></li>
            <li><a href="userCenter">个人中心</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right" th:if="${currentCus==null}">
            <li><a href="login">登录</a></li>
            <li><a href="signup">注册</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right" th:if="${currentCus!=null}">
            <li><a href="userCenter" th:text="${currentCus.customername}"></a></li>
            <li><a href="loginout" >注销</a></li>
        </ul>
    </div>
</div>

<!--图书信息展示区-->
<div class="container">
    <div class="row">
        <!--图书展示区-->
        <div class="col-sm-9">
            <!--图片和信息展示-->
            <div class="container" style="margin: auto">
                <div class="row">
                    <!--图片区-->
                    <div class="col-sm-4">
                        <img class="img-responsive" th:src="${book.bookpic}" style="width: 400px ; height: 450px"/>
                    </div>
                    <!--简介区-->
                    <div class="col-sm-5">
                            <label><h2 th:text="${book.bookname}"></h2></label>

                            <ul class="list-group" style="margin-top: 50px">
                                <li class="list-group-item">作者/译者：<label th:text="${book.bookauthor}"></label></li>
                                <li class="list-group-item">出版社：<label th:text="${book.bookpress}"></label></li>
                                <li class="list-group-item">库存：<label th:text="${book.bookstoremount}"></label></li>
                                <li class="list-group-item">成交量：<label th:text="${book.bookdealmount}"></label></li>
                                <li class="list-group-item">浏览次数：<label th:text="${book.booklookmount}"></label></li>
                                <li class="list-group-item">售价：<label th:text="${book.bookprprice}"></label></li>
                                <li class="list-group-item">ISBN：<label th:text="${book.bookisbn}"></label></li>
                            </ul>
                            <input class="min" name="" type="button" value="-"/>
                            <input class="text_box" id="num" type="text" value="1" style="width:25px;"/>
                            <input class="add" name="" type="button" value="+"/>

                            <div class="btn-group btn-group-lg">
                                <button id="iComment" type="button" class="btn btn-default">我要评论</button>
                                <button id="iCart" type="button" class="btn btn-default" >
                                    加入购物车
                                </button>
                                <button id="iBuy" type="button" class="btn btn-primary">购买</button>
                            </div>
                    </div>
                </div>
            </div>
            <!--分割线-->
            <div class="container" style="position: center;margin-top: 50px">
                <div class="row">
                    <div class="col-sm-9">
                        <HR style="FILTER: progid:DXImageTransform.Microsoft.Glow(color=#987cb9,strength=10)"
                            width="80%"
                            color=#987cb9 SIZE=1>
                    </div>
                </div>
            </div>
            <!--详情说明区-->
            <div class="container" style="margin: auto">
                <div class="row">
                    <div class="col-sm-9">
                        <div class="panel-group" id="accordion">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion"
                                           href="#collapseOne" th:text="${details.details1}">

                                        </a>
                                    </h4>
                                </div>
                                <div id="collapseOne" class="panel-collapse collapse in">
                                    <div class="panel-body" >
                                        <p th:text="${details.details1}"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-success">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion"
                                           href="#collapseTwo" th:text="${details.details2}">

                                        </a>
                                    </h4>
                                </div>
                                <div id="collapseTwo" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <p th:text="${details.details2}"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-info">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion"
                                           href="#collapseThree" th:text="${details.details3}">

                                        </a>
                                    </h4>
                                </div>
                                <div id="collapseThree" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <p th:text="${details.details3}"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-warning">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion"
                                           href="#collapseFour" th:text="${details.details4}">

                                        </a>
                                    </h4>
                                </div>
                                <div id="collapseFour" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <p th:text="${details.details4}"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--评论区-->
        <div class="col-sm-3">
            <!--有害信息举报-->
            <div class="side-bar-well clearfix">
                <div class="col-sm-5"><img class="img-responsive" src="/img/1-1.png"/></div>
                <div class="col-sm-7">
                    <p class="side-bar-well-title">
                        网上有害信息举报专区
                    </p>
                    <p>举报电话：12315</p>
                </div>
            </div>
            <!--评论展示面板-->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        有关评论：
                    </h3>
                </div>
                <div th:each="comment:${comments}">
                    <div class="panel-body">
                        <label th:text="${comment.customername}"></label>
                        <p th:text="${comment.content}"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="footer">
  © 2017 森林书城 中国互联网举报中心京ICP证1401号京ICP备125439号-3京公网安备
</div>

<script th:inline="javascript">
    $(function () { $('#collapseFour').collapse({
        toggle: false
    })});
    $(function () { $('#collapseTwo').collapse('show')});
    $(function () { $('#collapseThree').collapse('toggle')});
    $(function () { $('#collapseOne').collapse('hide')});

    $(function () {
        $(".add").click(function() {
            // $(this).prev() 就是当前元素的前一个元素，即 text_box
            $(this).prev().val(parseInt($(this).prev().val()) + 1);
            setTotal();
        });

        $(".min").click(function() {
            // $(this).next() 就是当前元素的下一个元素，即 text_box
            if($(this).next().val() <= 0){
                $(this).next().val(0);
            }else{
                $(this).next().val(parseInt($(this).next().val()) - 1);
            }

            setTotal();
        });
    });

    $(function () {
       $("#iCart").click(function (e) {
           var userid = /*[[${currentCus.customerid}]]*/ 'null';
           var  bookid = /*[[${book.bookid}]]*/ 'null';
           var price = /*[[${book.bookprprice}]]*/ 'null';
           var mount = $("#num").val() ;
           var ispaid = 'no' ;
           console.log(userid+","+bookid+","+price+","+mount+","+ispaid) ;

           var json = {
               'customerid':userid,
               'bookid':bookid,
               'ordermount':mount,
               'price':price,
               'ispaid':ispaid
           };
           console.log(json);
           //封装成json对象
           var postdata = JSON.stringify(json);
           console.log(postdata);

           $.ajax({
               url: "addCart",
               data: postdata,
               type: "POST",
               contentType: "application/json;charset=utf-8",
               success: function (data) {
                   alert(data);
               },
               error:function(error){alert(error);}
           });

       });
    });

</script>

</body>

</html>
